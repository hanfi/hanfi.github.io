language: ruby
sudo: false
dist: trusty
rvm:
  - 2.3.3
cache: bundler
install:
  - gem install jekyll
  - gem install html-proofer
  - npm install -g snyk
  - snyk auth $SNYK_TOKEN
script:
  - bundle install
  - jekyll build
  - jekyll hyde
  - snyk test
  - bundle exec htmlproofer --check-html --check-img-http --check-opengraph --enforce-https --check-favicon --assume-extension --http-status-ignore "999" --url-ignore "/jekyllrb.com/" ./_site
after_success:
  - snyk monitor
env:
  global:
    - NOKOGIRI_USE_SYSTEM_LIBRARIES=true
